"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[62703],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var o=t(96540);const a={},s=o.createContext(a);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},94399:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"zio-http/reference/socket/websocketframe","title":"WebSocketFrame","description":"In the WebSocket protocol, communication happens using frames. ZIO","source":"@site/docs/zio-http/reference/socket/websocketframe.md","sourceDirName":"zio-http/reference/socket","slug":"/zio-http/reference/socket/websocketframe","permalink":"/zio-http/reference/socket/websocketframe","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-http/reference/socket/websocketframe.md","tags":[],"version":"current","frontMatter":{"id":"websocketframe","title":"WebSocketFrame"},"sidebar":"ecosystem-sidebar","previous":{"title":"Socket","permalink":"/zio-http/reference/socket/"},"next":{"title":"ZIO HTTP","permalink":"/zio-http/"}}');var a=t(74848),s=t(28453);const r={id:"websocketframe",title:"WebSocketFrame"},c=void 0,i={},l=[{value:"Text",id:"text",level:2},{value:"Binary",id:"binary",level:2},{value:"Continuation",id:"continuation",level:2},{value:"Close",id:"close",level:2},{value:"Constructing Close with just status",id:"constructing-close-with-just-status",level:3},{value:"Constructing Close with status and a reason",id:"constructing-close-with-status-and-a-reason",level:3},{value:"Ping",id:"ping",level:2},{value:"Pong",id:"pong",level:2},{value:"Pattern Matching on WebSocketFrame",id:"pattern-matching-on-websocketframe",level:3}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["In the ",(0,a.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6455",children:"WebSocket"})," protocol, communication happens using frames. ZIO\nHTTP's ",(0,a.jsx)(n.a,{href:"https://github.com/zio/zio-http/blob/main/zio-http/src/main/scala/zio/socket/WebSocketFrame.scala",children:"WebSocketFrame"}),"\nis the representation of those frames. The domain defines the following type of frames:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Text"}),"\n",(0,a.jsx)(n.li,{children:"Binary"}),"\n",(0,a.jsx)(n.li,{children:"Continuation"}),"\n",(0,a.jsx)(n.li,{children:"Close"}),"\n",(0,a.jsx)(n.li,{children:"Ping"}),"\n",(0,a.jsx)(n.li,{children:"Pong"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"text",children:"Text"}),"\n",(0,a.jsxs)(n.p,{children:["To create a Text frame that models textual data in the WebSocket protocol, you can use the ",(0,a.jsx)(n.code,{children:"text"})," constructor."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:'import zio.http._\n\nWebSocketFrame.text("Hello from ZIO-HTTP")\n'})}),"\n",(0,a.jsx)(n.h2,{id:"binary",children:"Binary"}),"\n",(0,a.jsxs)(n.p,{children:["To create a Binary frame that models raw binary data, you can use the ",(0,a.jsx)(n.code,{children:"binary"})," constructor."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:'import zio.Chunk\nimport java.nio.charset.StandardCharsets\n\nWebSocketFrame.binary(Chunk.fromArray("Hello from ZIO-HTTP".getBytes(StandardCharsets.UTF_16)))\n'})}),"\n",(0,a.jsx)(n.h2,{id:"continuation",children:"Continuation"}),"\n",(0,a.jsxs)(n.p,{children:["To create a Continuation frame to model a continuation fragment of the previous message, you can use the ",(0,a.jsx)(n.code,{children:"continuation"}),"\nconstructor."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:'WebSocketFrame.continuation(Chunk.fromArray("Hello from ZIO-HTTP".getBytes(StandardCharsets.UTF_16)))\n'})}),"\n",(0,a.jsx)(n.h2,{id:"close",children:"Close"}),"\n",(0,a.jsxs)(n.p,{children:["To create a Close frame for a situation where the connection needs to be closed, you can use the ",(0,a.jsx)(n.code,{children:"close"})," constructor.\nThe constructor requires two arguments:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Status"}),"\n",(0,a.jsx)(n.li,{children:"Optional reason."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"constructing-close-with-just-status",children:"Constructing Close with just status"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:"WebSocketFrame.close(1000)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"constructing-close-with-status-and-a-reason",children:"Constructing Close with status and a reason"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:'WebSocketFrame.close(1000, Some("Normal Closure"))\n'})}),"\n",(0,a.jsxs)(n.p,{children:["More information on status codes can be found\nin ",(0,a.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6455#section-7.4",children:"Section 7.4"})," of IETF's Data Tracker."]}),"\n",(0,a.jsx)(n.h2,{id:"ping",children:"Ping"}),"\n",(0,a.jsx)(n.p,{children:"Ping models heartbeat in the WebSocket protocol. The server or the client can at any time, after a successful handshake,\nsend a ping frame."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:"WebSocketFrame.ping\n"})}),"\n",(0,a.jsx)(n.h2,{id:"pong",children:"Pong"}),"\n",(0,a.jsxs)(n.p,{children:["Pong models the second half of the heartbeat in the WebSocket protocol. Upon receiving ",(0,a.jsx)(n.a,{href:"#ping",children:"ping"}),", a pong needs to be\nsent back."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:"WebSocketFrame.ping\n"})}),"\n",(0,a.jsx)(n.h3,{id:"pattern-matching-on-websocketframe",children:"Pattern Matching on WebSocketFrame"}),"\n",(0,a.jsxs)(n.p,{children:["ZIO HTTP envisions the WebSocketFrame as a ",(0,a.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Tagged_union",children:"Sum"})," type, which allows\nexhaustive pattern matching to be performed on it."]}),"\n",(0,a.jsx)(n.p,{children:"You can do pattern matching on the WebSocketFrame type in the following way:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-scala",children:"val frame: WebSocketFrame = ...\n\nframe match {\n  case WebSocketFrame.Binary(bytes) => ???\n  case WebSocketFrame.Text(text) => ???\n  case WebSocketFrame.Close(status, reason) => ???\n  case WebSocketFrame.Ping => ???\n  case WebSocketFrame.Pong => ???\n  case WebSocketFrame.Continuation(buffer) => ???\n}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);