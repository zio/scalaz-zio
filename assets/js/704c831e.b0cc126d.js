"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[63728],{4844:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>t,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>g});const r=JSON.parse('{"id":"zio-logging/slf4j2","title":"SLF4J v2","description":"The Simple Logging Facade for Java (SLF4J v2 - using JDK9+ module system JPMS) serves as a simple facade or abstraction for various logging frameworks (e.g. java.util.logging, logback, log4j).","source":"@site/docs/zio-logging/slf4j2.md","sourceDirName":"zio-logging","slug":"/zio-logging/slf4j2","permalink":"/zio-logging/slf4j2","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-logging/slf4j2.md","tags":[],"version":"current","frontMatter":{"id":"slf4j2","title":"SLF4J v2"},"sidebar":"ecosystem-sidebar","previous":{"title":"java.util.logging bridge","permalink":"/zio-logging/jul-bridge"},"next":{"title":"SLF4J v1","permalink":"/zio-logging/slf4j1"}}');var l=o(74848),a=o(28453);const i={id:"slf4j2",title:"SLF4J v2"},s=void 0,t={},g=[{value:"Examples",id:"examples",level:2},{value:"SLF4J logger name and annotations",id:"slf4j-logger-name-and-annotations",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:["The Simple Logging Facade for Java (",(0,l.jsx)(n.a,{href:"https://www.slf4j.org/",children:(0,l.jsx)(n.code,{children:"SLF4J v2"})})," - using JDK9+ module system ",(0,l.jsx)(n.a,{href:"http://openjdk.java.net/projects/jigsaw/spec/",children:"JPMS"}),") serves as a simple facade or abstraction for various logging frameworks (e.g. java.util.logging, logback, log4j)."]}),"\n",(0,l.jsx)(n.p,{children:"In order to use this logging backend, we need to add the following line in our build.sbt file:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:'libraryDependencies += "dev.zio" %% "zio-logging-slf4j2" % "2.4.0"\n'})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.em,{children:"NOTE:"})})," SLF4J v2 implementation is similar to ",(0,l.jsx)(n.a,{href:"/zio-logging/slf4j1",children:"v1"}),",\nhowever there are some differences, v1 using ",(0,l.jsx)(n.a,{href:"https://logback.qos.ch/manual/mdc.html",children:"MDC context"}),", working with JDK8,\nv2 using ",(0,l.jsx)(n.a,{href:"https://www.slf4j.org/manual.html#fluent",children:"key-value pairs"}),", working with JDK9+."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Logger layer:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:"import zio.logging.backend.SLF4J\n\nval logger = Runtime.removeDefaultLoggers >>> SLF4J.slf4j\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Default ",(0,l.jsx)(n.code,{children:"SLF4J"})," logger setup:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["logger name (by default)  is extracted from ",(0,l.jsx)(n.code,{children:"zio.Trace"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["for example, trace ",(0,l.jsx)(n.code,{children:"zio.logging.example.Slf4jSimpleApp.run(Slf4jSimpleApp.scala:17)"})," will have ",(0,l.jsx)(n.code,{children:"zio.logging.example.Slf4jSimpleApp"})," as logger name"]}),"\n",(0,l.jsxs)(n.li,{children:["NOTE: custom logger name may be set by ",(0,l.jsx)(n.code,{children:"zio.logging.loggerName"})," aspect"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["all annotations (logger name and log marker name annotations are excluded) are passed like ",(0,l.jsx)(n.a,{href:"https://www.slf4j.org/manual.html#fluent",children:"key-value pairs"})]}),"\n",(0,l.jsx)(n.li,{children:"cause is logged as throwable"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["See also ",(0,l.jsx)(n.a,{href:"/zio-logging/formatting-log-records#logformat-and-logappender",children:"LogFormat and LogAppender"})]}),"\n",(0,l.jsx)(n.p,{children:"Custom logger name set by aspect:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:'ZIO.logInfo("Starting user operation") @@ zio.logging.loggerName("zio.logging.example.UserOperation")\n'})}),"\n",(0,l.jsx)(n.p,{children:"Log marker name set by aspect:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:'ZIO.logInfo("Confidential user operation") @@ SLF4J.logMarkerName("CONFIDENTIAL")\n'})}),"\n",(0,l.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,l.jsxs)(n.p,{children:["You can find the source code ",(0,l.jsx)(n.a,{href:"https://github.com/zio/zio-logging/tree/master/examples",children:"here"})]}),"\n",(0,l.jsx)(n.h3,{id:"slf4j-logger-name-and-annotations",children:"SLF4J logger name and annotations"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:'package zio.logging.example\n\nimport zio.logging.LogAnnotation\nimport zio.logging.backend.SLF4J\nimport zio.{ ExitCode, Runtime, Scope, ZIO, ZIOAppDefault, _ }\n\nimport java.util.UUID\n\nobject Slf4jSimpleApp extends ZIOAppDefault {\n\n  override val bootstrap: ZLayer[ZIOAppArgs, Any, Any] = Runtime.removeDefaultLoggers >>> SLF4J.slf4j\n\n  private val users = List.fill(2)(UUID.randomUUID())\n\n  override def run: ZIO[Scope, Any, ExitCode] =\n    for {\n      _       <- ZIO.logInfo("Start")\n      traceId <- ZIO.succeed(UUID.randomUUID())\n      _       <- ZIO.foreachPar(users) { uId =>\n        {\n          ZIO.logInfo("Starting user operation") *>\n            ZIO.logInfo("Confidential user operation") @@ SLF4J.logMarkerName("CONFIDENTIAL") *>\n            ZIO.sleep(500.millis) *>\n            ZIO.logInfo("Stopping user operation")\n        } @@ ZIOAspect.annotated("user", uId.toString)\n      } @@ LogAnnotation.TraceId(traceId) @@ zio.logging.loggerName("zio.logging.example.UserOperation")\n      _       <- ZIO.logInfo("Done")\n    } yield ExitCode.success\n\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Logback configuration:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">\n        <layout class="ch.qos.logback.classic.PatternLayout">\n            <Pattern>%d{HH:mm:ss.SSS} [%thread] [%kvp] %-5level %logger{36} %msg%n</Pattern>\n        </layout>\n    </appender>\n    <turboFilter class="ch.qos.logback.classic.turbo.MarkerFilter">\n        <Name>CONFIDENTIAL_FILTER</Name>\n        <Marker>CONFIDENTIAL</Marker>\n        <OnMatch>DENY</OnMatch>\n    </turboFilter>\n    <root level="debug">\n        <appender-ref ref="STDOUT" />\n    </root>\n</configuration>\n'})}),"\n",(0,l.jsx)(n.p,{children:"Expected Console Output:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'12:13:17.495 [ZScheduler-Worker-8] [] INFO  zio.logging.example.Slf4j2SimpleApp Start\n12:13:17.601 [ZScheduler-Worker-11] [trace_id="7826dd28-7e37-4b54-b84d-05399bb6cbeb" user="7b6a1af5-bad2-4846-aa49-138d31b40a24"] INFO  zio.logging.example.UserOperation Starting user operation\n12:13:17.601 [ZScheduler-Worker-10] [trace_id="7826dd28-7e37-4b54-b84d-05399bb6cbeb" user="4df9cdbc-e770-4bc9-b884-756e671a6435"] INFO  zio.logging.example.UserOperation Starting user operation\n12:13:18.167 [ZScheduler-Worker-13] [trace_id="7826dd28-7e37-4b54-b84d-05399bb6cbeb" user="7b6a1af5-bad2-4846-aa49-138d31b40a24"] INFO  zio.logging.example.UserOperation Stopping user operation\n12:13:18.167 [ZScheduler-Worker-15] [trace_id="7826dd28-7e37-4b54-b84d-05399bb6cbeb" user="4df9cdbc-e770-4bc9-b884-756e671a6435"] INFO  zio.logging.example.UserOperation Stopping user operation\n12:13:18.173 [ZScheduler-Worker-13] [] INFO  zio.logging.example.Slf4j2SimpleApp Done\n'})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>s});var r=o(96540);const l={},a=r.createContext(l);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);