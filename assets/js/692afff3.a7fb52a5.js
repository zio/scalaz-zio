"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[69442],{26861:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>g,contentTitle:()=>t,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>s});const a=JSON.parse('{"id":"zio-logging/jpl","title":"Java Platform/System Logger","description":"Java Platform/System Logger is logging API which was introduced in Java 9.","source":"@site/docs/zio-logging/jpl.md","sourceDirName":"zio-logging","slug":"/zio-logging/jpl","permalink":"/zio-logging/jpl","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-logging/jpl.md","tags":[],"version":"current","frontMatter":{"id":"jpl","title":"Java Platform/System Logger"},"sidebar":"ecosystem-sidebar","previous":{"title":"Reconfigurable Logger","permalink":"/zio-logging/reconfigurable-logger"},"next":{"title":"java.util.logging bridge","permalink":"/zio-logging/jul-bridge"}}');var i=o(74848),l=o(28453);const r={id:"jpl",title:"Java Platform/System Logger"},t=void 0,g={},s=[{value:"Examples",id:"examples",level:2},{value:"Java Platform/System logger name and annotations",id:"java-platformsystem-logger-name-and-annotations",level:3},{value:"Feature changes",id:"feature-changes",level:2},{value:"Version 2.2.0",id:"version-220",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://openjdk.org/jeps/264",children:(0,i.jsx)(n.code,{children:"Java Platform/System Logger"})})," is logging API which was introduced in Java 9."]}),"\n",(0,i.jsx)(n.p,{children:"In order to use this logging backend, we need to add the following line in our build.sbt file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'libraryDependencies += "dev.zio" %% "zio-logging-jpl" % "2.5.0"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Logger layer:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio.logging.backend.JPL\n\nval logger = Runtime.removeDefaultLoggers >>> JPL.jpl\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"JPL"})," logger setup:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["logger name (by default)  is extracted from ",(0,i.jsx)(n.code,{children:"zio.Trace"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["for example, trace ",(0,i.jsx)(n.code,{children:"zio.logging.example.JplSimpleApp.run(JplSimpleApp.scala:17)"})," will have ",(0,i.jsx)(n.code,{children:"zio.logging.example.JplSimpleApp"})," as logger name"]}),"\n",(0,i.jsxs)(n.li,{children:["NOTE: custom logger name may be set by ",(0,i.jsx)(n.code,{children:"zio.logging.loggerName"})," aspect"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"all annotations (logger name annotation is excluded) are placed at the beginning of log message"}),"\n",(0,i.jsx)(n.li,{children:"cause is logged as throwable"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See also ",(0,i.jsx)(n.a,{href:"/zio-logging/formatting-log-records#logformat-and-logappender",children:"LogFormat and LogAppender"})]}),"\n",(0,i.jsx)(n.p,{children:"Custom logger name set by aspect:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'ZIO.logInfo("Starting user operation") @@ zio.logging.loggerName("zio.logging.example.UserOperation")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["You can find the source code ",(0,i.jsx)(n.a,{href:"https://github.com/zio/zio-logging/tree/master/examples",children:"here"})]}),"\n",(0,i.jsx)(n.h3,{id:"java-platformsystem-logger-name-and-annotations",children:"Java Platform/System logger name and annotations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'package zio.logging.example\n\nimport zio.logging.LogAnnotation\nimport zio.logging.backend.JPL\nimport zio.{ ExitCode, Runtime, Scope, ZIO, ZIOAppDefault, _ }\n\nimport java.util.UUID\n\nobject JplSimpleApp extends ZIOAppDefault {\n\n  override val bootstrap: ZLayer[ZIOAppArgs, Any, Any] = Runtime.removeDefaultLoggers >>> JPL.jpl\n\n  private val users = List.fill(2)(UUID.randomUUID())\n\n  override def run: ZIO[Scope, Any, ExitCode] =\n    for {\n      _       <- ZIO.logInfo("Start")\n      traceId <- ZIO.succeed(UUID.randomUUID())\n      _       <- ZIO.foreachPar(users) { uId =>\n        {\n          ZIO.logInfo("Starting user operation") *>\n            ZIO.sleep(500.millis) *>\n            ZIO.logInfo("Stopping user operation")\n        } @@ ZIOAspect.annotated("user", uId.toString)\n      } @@ LogAnnotation.TraceId(traceId) @@ zio.logging.loggerName("zio.logging.example.UserOperation")\n      _       <- ZIO.logInfo("Done")\n    } yield ExitCode.success\n\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Expected Console Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Oct 28, 2022 1:47:01 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: Start\nOct 28, 2022 1:47:01 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: user=59c114fd-676d-4df9-a5a0-b8e132468fbf trace_id=7d3e3b84-dd3b-44ff-915a-04fb2d135e28 Starting user operation\nOct 28, 2022 1:47:01 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: user=e1ebf0cc-2f61-484f-afcd-de7e20ec7829 trace_id=7d3e3b84-dd3b-44ff-915a-04fb2d135e28 Starting user operation\nOct 28, 2022 1:47:02 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: user=e1ebf0cc-2f61-484f-afcd-de7e20ec7829 trace_id=7d3e3b84-dd3b-44ff-915a-04fb2d135e28 Stopping user operation\nOct 28, 2022 1:47:02 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: user=59c114fd-676d-4df9-a5a0-b8e132468fbf trace_id=7d3e3b84-dd3b-44ff-915a-04fb2d135e28 Stopping user operation\nOct 28, 2022 1:47:02 PM zio.logging.backend.JPL$$anon$1 $anonfun$closeLogEntry$1\nINFO: Done\n"})}),"\n",(0,i.jsx)(n.h2,{id:"feature-changes",children:"Feature changes"}),"\n",(0,i.jsx)(n.h3,{id:"version-220",children:"Version 2.2.0"}),"\n",(0,i.jsxs)(n.p,{children:["Deprecated log annotation with key ",(0,i.jsx)(n.code,{children:"jpl_logger_name"})," (",(0,i.jsx)(n.code,{children:"JPL.loggerNameAnnotationKey"}),") removed,\nonly common log annotation with key ",(0,i.jsx)(n.code,{children:"logger_name"})," (",(0,i.jsx)(n.code,{children:"zio.logging.loggerNameAnnotationKey"}),") for logger name is supported now."]})]})}function c(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>t});var a=o(96540);const i={},l=a.createContext(i);function r(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);