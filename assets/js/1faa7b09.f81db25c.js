"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[11706],{10315:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"ecosystem/community/zio-k8s","title":"ZIO K8s","description":"ZIO K8S is an idiomatic ZIO client for the Kubernetes API.","source":"@site/docs/ecosystem/community/zio-k8s.md","sourceDirName":"ecosystem/community","slug":"/ecosystem/community/zio-k8s","permalink":"/ecosystem/community/zio-k8s","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/ecosystem/community/zio-k8s.md","tags":[],"version":"current","frontMatter":{"id":"zio-k8s","title":"ZIO K8s"},"sidebar":"ecosystem-sidebar","previous":{"title":"ZIO gRPC","permalink":"/ecosystem/community/zio-grpc"},"next":{"title":"ZIO Kinesis","permalink":"/ecosystem/community/zio-kinesis"}}');var t=o(74848),s=o(28453);const r={id:"zio-k8s",title:"ZIO K8s"},c=void 0,l={},a=[{value:"Introduction",id:"introduction",level:2},{value:"Installation",id:"installation",level:2},{value:"Example",id:"example",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://github.com/coralogix/zio-k8s",children:"ZIO K8S"})," is an idiomatic ZIO client for the Kubernetes API."]}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"This library provides a client for the full Kubernetes API as well as providing code generator support for custom resources and higher-level concepts such as operators, taking full advantage of the ZIO library."}),"\n",(0,t.jsx)(n.p,{children:"Using ZIO K8S we can talk to the Kubernetes API that helps us to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Write an operator for our custom resource types"}),"\n",(0,t.jsx)(n.li,{children:"Schedule some jobs in our cluster"}),"\n",(0,t.jsx)(n.li,{children:"Query the cluster for monitoring purposes"}),"\n",(0,t.jsx)(n.li,{children:"Write some cluster management tools"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsxs)(n.p,{children:["In order to use this library, we need to add the following line in our ",(0,t.jsx)(n.code,{children:"build.sbt"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'libraryDependencies += "com.coralogix" %% "zio-k8s-client" % "1.3.3"\n'})}),"\n",(0,t.jsx)(n.p,{children:"And then we need to choose the proper sttp backend:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'"com.softwaremill.sttp.client3" %% "httpclient-backend-zio" % "3.1.1",\n"com.softwaremill.sttp.client3" %% "slf4j-backend"          % "3.1.1"\n'})}),"\n",(0,t.jsx)(n.p,{children:"Or the asynchronous version:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'"com.softwaremill.sttp.client3" %% "async-http-client-backend-zio" % "3.1.1"\n"com.softwaremill.sttp.client3" %% "slf4j-backend"                 % "3.1.1"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.p,{children:"This is an example of printing the tail logs of a container:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'import com.coralogix.zio.k8s.client.K8sFailure\nimport com.coralogix.zio.k8s.client.config.httpclient._\nimport com.coralogix.zio.k8s.client.model.K8sNamespace\nimport com.coralogix.zio.k8s.client.v1.pods\nimport com.coralogix.zio.k8s.client.v1.pods.Pods\nimport zio._\nimport zio.console.Console\n\nimport scala.languageFeature.implicitConversions\n\nobject ZIOK8sLogsExample extends zio.App {\n  override def run(args: List[String]): URIO[zio.ZEnv, ExitCode] = (args match {\n    case List(podName) => tailLogs(podName, None)\n    case List(podName, containerName) => tailLogs(podName, Some(containerName))\n    case _ => console.putStrLnErr("Usage: <podname> [containername]")\n  })\n    .provideCustom(k8sDefault >>> Pods.live)\n    .exitCode\n\n  def tailLogs(podName: String,\n               containerName: Option[String]\n              ): ZIO[Pods with Console, K8sFailure, Unit] =\n    pods\n      .getLog(\n        name = podName,\n        namespace = K8sNamespace.default,\n        container = containerName,\n        follow = Some(true)\n      )\n      .tap { line: String =>\n        console.putStrLn(line).ignore\n      }\n      .runDrain\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.youtube.com/watch?v=BUMe2hGKjXA&t=31s",children:"ZIO World - ZIO Kubernetes (ZIO K8S 1.0)"})," by Daniel Vigovszky (March 2020) \u2014 ZIO K8S 1.0, a new library by Daniel Vigovszky and Coralogix for working with Kubernetes, which includes support for the whole API, including event processors and compositional aspects for metrics and logging."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>c});var i=o(96540);const t={},s=i.createContext(t);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);