"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[48428],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var r=t(96540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}},88330:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"zio-metrics-connectors/metrics/micrometer-connector","title":"Micrometer Connector","description":"ZIO Metrics has an integration with Micrometer, a powerful metrics instrumentation library.","source":"@site/docs/zio-metrics-connectors/metrics/micrometer-connector.md","sourceDirName":"zio-metrics-connectors/metrics","slug":"/zio-metrics-connectors/metrics/micrometer-connector","permalink":"/zio-metrics-connectors/metrics/micrometer-connector","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-metrics-connectors/metrics/micrometer-connector.md","tags":[],"version":"current","frontMatter":{"id":"micrometer-connector","title":"Micrometer Connector"},"sidebar":"ecosystem-sidebar","previous":{"title":"Prometheus Client","permalink":"/zio-metrics-connectors/metrics/prometheus-client"},"next":{"title":"Instrumentation Examples","permalink":"/zio-metrics-connectors/metrics/instrumentation-examples"}}');var i=t(74848),o=t(28453);const s={id:"micrometer-connector",title:"Micrometer Connector"},c=void 0,a={},l=[{value:"Benefits",id:"benefits",level:2},{value:"1. Comprehensive Metrics Support",id:"1-comprehensive-metrics-support",level:3},{value:"2. Real-time Metrics Updates",id:"2-real-time-metrics-updates",level:3},{value:"3. Always on trend of standards",id:"3-always-on-trend-of-standards",level:3},{value:"Example of usage",id:"example-of-usage",level:2}];function m(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["ZIO Metrics has an integration with ",(0,i.jsx)(n.a,{href:"https://micrometer.io/",children:"Micrometer"}),", a powerful metrics instrumentation library.\nBy combining these two frameworks, developers can benefit from comprehensive and flexible metrics monitoring capabilities\nwithin their ZIO applications. This integration allows for efficient monitoring, gathering, and reporting of key\nperformance indicators (KPIs) and other metrics for enhanced observability."]}),"\n",(0,i.jsx)(n.h2,{id:"benefits",children:"Benefits"}),"\n",(0,i.jsx)(n.p,{children:"Micrometer integration offers a range of benefits that make it an excellent choice for integrating with ZIO Metrics.\nHere are some key advantages:"}),"\n",(0,i.jsx)(n.h3,{id:"1-comprehensive-metrics-support",children:"1. Comprehensive Metrics Support"}),"\n",(0,i.jsx)(n.p,{children:"Micrometer provides a vendor-neutral facade for various monitoring systems, including Prometheus, Datadog, Graphite,\nand more. The same like slf4j for logs but for observability. It offers a unified API for recording metrics, allowing\ndevelopers to easily integrate with multiple backend systems and switch between different monitoring systems without\nmajor code changes for its ZIO applications. You can choose whatever you want as monitoring tool - Grafana,\nPrometheus, and Jaeger and so on."}),"\n",(0,i.jsx)(n.h3,{id:"2-real-time-metrics-updates",children:"2. Real-time Metrics Updates"}),"\n",(0,i.jsx)(n.p,{children:"By leveraging the low-level integration with the ZIO Metrics core client listener, the module provides immediate\nupdates to Micrometer whenever metric changes occur within the ZIO application. This real-time synchronization\nensures that the metrics reported by Micrometer accurately reflect the current state of the application, enabling\ntimely monitoring and analysis."}),"\n",(0,i.jsx)(n.h3,{id:"3-always-on-trend-of-standards",children:"3. Always on trend of standards"}),"\n",(0,i.jsx)(n.p,{children:"Integration with Micrometer ensures that developers are always on trend of standards with metrics format changes and\ncan take advantage of the latest updates and improvements in the monitoring ecosystem. By relying on Micrometer as\nthe integration layer, developers gain compatibility with the latest monitoring systems, future-proof their\nmonitoring infrastructure, benefit from community-driven updates and support, and simplify maintenance and upgrades.\nThis integration provides a reliable and scalable solution for metrics monitoring in ZIO-based applications, allowing\ndevelopers to focus on their core business logic while staying at the forefront of monitoring technology."}),"\n",(0,i.jsx)(n.h2,{id:"example-of-usage",children:"Example of usage"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Import Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"In your project's build configuration, add the following dependency to import the ZIO Metrics Micrometer module:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'   libraryDependencies += "dev.zio" %% "zio-metrics-connectors-micrometer" % latest\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Choose Micrometer Backend"}),"\n",(0,i.jsx)(n.p,{children:"Decide on the backend for the Micrometer registry. You can use the built-in\n'SimpleMeterRegistry', which stores all metrics in memory (commonly used for testing), or select another backend for\nexternal integration. In this example, we'll use Prometheus as the backend."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'   "io.micrometer" % "micrometer-registry-prometheus" % latest\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Provide Micrometer and its backend Layer to your main ZIO effect"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"zio-metrics-connectors-micrometer"})," gives you ",(0,i.jsx)(n.code,{children:"micrometer.micrometerLayer"})," which initializes a bridge between ZIO Metrics and\nMicrometer.\nYou should also provide a layer with a backend for micrometer."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Optionally enable Core ZIO Metrics and Default JVM Metrics"}),"\n",(0,i.jsxs)(n.p,{children:["Enable core ZIO Metrics by providing ",(0,i.jsx)(n.code,{children:"Runtime.enableRuntimeMetrics"})," to your main application's ZIO effect. This\nensures that basic ZIO metrics, such as fiber counts and execution times, are collected. Additionally, include\n",(0,i.jsx)(n.code,{children:"DefaultJvmMetrics.live"})," in your layer composition to enable default JVM metrics collection."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Here's an example of how example may look like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"\nobject SampleApp extends ZIOAppDefault {\n\n  def program[R, E, T]: ZIO[R, E, T] = ???\n\n  override def run: ZIO[Environment & ZIOAppArgs & Scope, Any, Any] = (for {\n    _ <- program\n  } yield ())\n    .provide(\n      micrometer.micrometerLayer,\n      ZLayer.succeed(new PrometheusMeterRegistry(PrometheusConfig.DEFAULT)),\n      Runtime.enableRuntimeMetrics,\n      DefaultJvmMetrics.live.unit,\n    )\n}\n\n"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);