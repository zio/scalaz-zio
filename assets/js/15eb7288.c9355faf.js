"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[3823],{20390:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"zio-interop-reactivestreams/index","title":"Introduction to ZIO Interop Reactive Streams","description":"This library provides an interoperability layer between ZIO and reactive streams.","source":"@site/docs/zio-interop-reactivestreams/index.md","sourceDirName":"zio-interop-reactivestreams","slug":"/zio-interop-reactivestreams/","permalink":"/zio-interop-reactivestreams/","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-interop-reactivestreams/index.md","tags":[],"version":"current","frontMatter":{"id":"index","title":"Introduction to ZIO Interop Reactive Streams","sidebar_label":"ZIO Interop Reactive Streams"},"sidebar":"ecosystem-sidebar","previous":{"title":"ZIO Interop Monix","permalink":"/interop-monix/"},"next":{"title":"ZIO Interop Scalaz","permalink":"/zio-interop-scalaz/"}}');var t=s(74848),n=s(28453);const o={id:"index",title:"Introduction to ZIO Interop Reactive Streams",sidebar_label:"ZIO Interop Reactive Streams"},a=void 0,c={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Installation",id:"installation",level:2},{value:"Examples",id:"examples",level:2},{value:"Publisher to Stream",id:"publisher-to-stream",level:3},{value:"Subscriber to Sink",id:"subscriber-to-sink",level:3},{value:"Stream to Publisher",id:"stream-to-publisher",level:3},{value:"Sink to Subscriber",id:"sink-to-subscriber",level:3}];function d(e){const r={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{children:"This library provides an interoperability layer between ZIO and reactive streams."}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"https://github.com/zio/zio/wiki/Project-Stages",children:(0,t.jsx)(r.img,{src:"https://img.shields.io/badge/Project%20Stage-Production%20Ready-brightgreen.svg",alt:"Production Ready"})})," ",(0,t.jsx)(r.img,{src:"https://github.com/zio/interop-reactive-streams/workflows/CI/badge.svg",alt:"CI Badge"})," ",(0,t.jsx)(r.a,{href:"https://oss.sonatype.org/content/repositories/releases/dev/zio/zio-interop-reactivestreams_2.13/",children:(0,t.jsx)(r.img,{src:"https://img.shields.io/nexus/r/https/oss.sonatype.org/dev.zio/zio-interop-reactivestreams_2.13.svg?label=Sonatype%20Release",alt:"Sonatype Releases"})})," ",(0,t.jsx)(r.a,{href:"https://oss.sonatype.org/content/repositories/snapshots/dev/zio/zio-interop-reactivestreams_2.13/",children:(0,t.jsx)(r.img,{src:"https://img.shields.io/nexus/s/https/oss.sonatype.org/dev.zio/zio-interop-reactivestreams_2.13.svg?label=Sonatype%20Snapshot",alt:"Sonatype Snapshots"})})," ",(0,t.jsx)(r.a,{href:"https://javadoc.io/doc/dev.zio/zio-interop-reactivestreams-docs_2.13",children:(0,t.jsx)(r.img,{src:"https://javadoc.io/badge2/dev.zio/zio-interop-reactivestreams-docs_2.13/javadoc.svg",alt:"javadoc"})})," ",(0,t.jsx)(r.a,{href:"https://github.com/zio/interop-reactive-streams",children:(0,t.jsx)(r.img,{src:"https://img.shields.io/github/stars/zio/interop-reactive-streams?style=social",alt:"ZIO Interop Reactive Streams"})})]}),"\n",(0,t.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"ZIO"})," integrates with ",(0,t.jsx)(r.a,{href:"http://reactive-streams.org",children:"Reactive Streams"})," by providing conversions from ",(0,t.jsx)(r.code,{children:"zio.stream.Stream"})," to ",(0,t.jsx)(r.code,{children:"org.reactivestreams.Publisher"})," and from ",(0,t.jsx)(r.code,{children:"zio.stream.Sink"})," to ",(0,t.jsx)(r.code,{children:"org.reactivestreams.Subscriber"})," and vice versa. Simply import ",(0,t.jsx)(r.code,{children:"import zio.interop.reactivestreams._"})," to make the conversions available."]}),"\n",(0,t.jsx)(r.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsxs)(r.p,{children:["In order to use this library, we need to add the following line in our ",(0,t.jsx)(r.code,{children:"build.sbt"})," file:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:'libraryDependencies += "dev.zio" %% "zio-interop-reactive-streams" % "2.0.2"\n'})}),"\n",(0,t.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(r.p,{children:"First, let's get a few imports out of the way."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import org.reactivestreams.example.unicast._\nimport zio._\nimport zio.interop.reactivestreams._\nimport zio.stream._\n"})}),"\n",(0,t.jsxs)(r.p,{children:["We use the following ",(0,t.jsx)(r.code,{children:"Publisher"})," and ",(0,t.jsx)(r.code,{children:"Subscriber"})," for the examples:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:'val publisher = new RangePublisher(3, 10)\nval subscriber = new SyncSubscriber[Int] {\n  override protected def whenNext(v: Int): Boolean = {\n    print(s"$v, ")\n    true\n  }\n}\n'})}),"\n",(0,t.jsx)(r.h3,{id:"publisher-to-stream",children:"Publisher to Stream"}),"\n",(0,t.jsxs)(r.p,{children:["A ",(0,t.jsx)(r.code,{children:"Publisher"})," used as a ",(0,t.jsx)(r.code,{children:"Stream"})," buffers up to ",(0,t.jsx)(r.code,{children:"qSize"})," elements. If possible, ",(0,t.jsx)(r.code,{children:"qSize"})," should be\na power of two for best performance. The default is 16."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"val streamFromPublisher = publisher.toZIOStream(qSize = 16)\nstreamFromPublisher.run(Sink.collectAll[Integer])\n"})}),"\n",(0,t.jsx)(r.h3,{id:"subscriber-to-sink",children:"Subscriber to Sink"}),"\n",(0,t.jsxs)(r.p,{children:["When running a ",(0,t.jsx)(r.code,{children:"Stream"})," to a ",(0,t.jsx)(r.code,{children:"Subscriber"}),", a side channel is needed for signalling failures.\nFor this reason ",(0,t.jsx)(r.code,{children:"toZIOSink"})," returns a tuple of a callback and a ",(0,t.jsx)(r.code,{children:"Sink"}),". The callback must be used to signal ",(0,t.jsx)(r.code,{children:"Stream"})," failure. The type parameter on ",(0,t.jsx)(r.code,{children:"toZIOSink"})," is the error type of ",(0,t.jsx)(r.em,{children:"the Stream"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:'val asSink = subscriber.toZIOSink[Throwable]\nval failingStream = ZStream.range(3, 13) ++ ZStream.fail(new RuntimeException("boom!"))\nZIO.scoped {\n  asSink.flatMap { case (signalError, sink) => // FIXME\n    failingStream.run(sink).catchAll(signalError)\n  }\n}\n'})}),"\n",(0,t.jsx)(r.h3,{id:"stream-to-publisher",children:"Stream to Publisher"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"val stream = Stream.range(3, 13)\nstream.toPublisher.flatMap { publisher =>\n  UIO(publisher.subscribe(subscriber))\n}\n"})}),"\n",(0,t.jsx)(r.h3,{id:"sink-to-subscriber",children:"Sink to Subscriber"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"toSubscriber"})," returns a ",(0,t.jsx)(r.code,{children:"Subscriber"})," and an ",(0,t.jsx)(r.code,{children:"IO"})," which completes with the result of running the ",(0,t.jsx)(r.code,{children:"Sink"})," or the error if the ",(0,t.jsx)(r.code,{children:"Publisher"})," fails.\nA ",(0,t.jsx)(r.code,{children:"Sink"})," used as a ",(0,t.jsx)(r.code,{children:"Subscriber"})," buffers up to ",(0,t.jsx)(r.code,{children:"qSize"})," elements. If possible, ",(0,t.jsx)(r.code,{children:"qSize"})," should be a power of two for best performance. The default is 16."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"val sink = Sink.collectAll[Integer]\nZIO.scoped {\n  sink.toSubscriber(qSize = 16).flatMap { case (subscriber, result) => \n    UIO(publisher.subscribe(subscriber)) *> result\n  }\n}\n"})})]})}function h(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,r,s)=>{s.d(r,{R:()=>o,x:()=>a});var i=s(96540);const t={},n=i.createContext(t);function o(e){const r=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(n.Provider,{value:r},e.children)}}}]);