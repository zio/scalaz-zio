"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[81313],{59619:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>c,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"zio-aws/aspects","title":"Aspects","description":"It is possible to define aspects of type AwsCallAspect[R] that can modify the behavior of the AWS client modules. This can be used for example","source":"@site/docs/zio-aws/aspects.md","sourceDirName":"zio-aws","slug":"/zio-aws/aspects","permalink":"/zio-aws/aspects","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-aws/aspects.md","tags":[],"version":"current","frontMatter":{"id":"aspects","title":"Aspects"},"sidebar":"ecosystem-sidebar","previous":{"title":"HTTP","permalink":"/zio-aws/http"},"next":{"title":"Examples","permalink":"/zio-aws/examples"}}');var a=t(74848),i=t(28453);const c={id:"aspects",title:"Aspects"},o="Aspects",r={},l=[];function p(e){const s={a:"a",code:"code",em:"em",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"aspects",children:"Aspects"})}),"\n",(0,a.jsxs)(s.p,{children:["It is possible to define ",(0,a.jsx)(s.em,{children:"aspects"})," of type ",(0,a.jsx)(s.code,{children:"AwsCallAspect[R]"})," that can modify the behavior of the AWS client modules. This can be used for example\nto add logging or metrics to the AWS clients and it's also the recommended way to handle retries or apply rate limiting and other similar patterns."]}),"\n",(0,a.jsx)(s.p,{children:"The library contains two default aspects, implementing logging and metrics on top of ZIO 2's core capabilities:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-scala",children:"val callLogging: AwsCallAspect[Any]\ndef callDuration(prefix: String, boundaries: MetricKeyType.Histogram.Boundaries): AwsCallAspect[Any]\n"})}),"\n",(0,a.jsxs)(s.p,{children:["To define an aspect, create an instance of the ",(0,a.jsx)(s.code,{children:"AwsCallAspect"})," trait:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-scala",children:'val callLogging: AwsCallAspect[Any] =\n    new AwsCallAspect[Any] {\n      override final def apply[R, E >: AwsError, A <: Described[_]](\n          f: ZIO[R, E, A]\n      )(implicit trace: Trace): ZIO[R, E, A] = {\n        f.either.timed\n          .flatMap {\n            case (duration, Right(r)) =>\n              ZIO.succeed(r)\n            case (duration, Left(error)) =>\n              Console\n                .printLine(\n                  s"AWS call FAILED in $duration with $error"\n                )\n                .ignore *> ZIO.fail(error)\n          }\n      }\n    }\n// callLogging: AwsCallAspect[Any] = repl.MdocSession$MdocApp$$anon$1@2ac186c1\n'})}),"\n",(0,a.jsxs)(s.p,{children:["This aspect can attached to a ",(0,a.jsx)(s.em,{children:"client layer"})," with the ",(0,a.jsx)(s.code,{children:"@@"})," operator. Multiple aspects can be composed with ",(0,a.jsx)(s.code,{children:">>>"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["To see a full example, check ",(0,a.jsx)(s.a,{href:"https://github.com/vigoo/zio-aws/blob/master/examples/example2/src/main/scala/Main.scala",children:"example #2"}),"."]})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>c,x:()=>o});var n=t(96540);const a={},i=n.createContext(a);function c(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);