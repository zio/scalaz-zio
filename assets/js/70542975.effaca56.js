"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[48942],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>c});var r=n(96540);const i={},o=r.createContext(i);function s(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:t},e.children)}},79791:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"zio-metrics-connectors/metrics/index","title":"Metrics","description":"ZIO Metrics enables the instrumentation of any ZIO based application with specialized aspects. The type of the original ZIO effect will not change by adding on or more aspects to it.","source":"@site/docs/zio-metrics-connectors/metrics/index.md","sourceDirName":"zio-metrics-connectors/metrics","slug":"/zio-metrics-connectors/metrics/","permalink":"/zio-metrics-connectors/metrics/","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/zio-metrics-connectors/metrics/index.md","tags":[],"version":"current","frontMatter":{"id":"index","title":"Metrics"},"sidebar":"ecosystem-sidebar","previous":{"title":"Getting Started","permalink":"/zio-metrics-connectors/getting-started"},"next":{"title":"ZIO Metric Reference","permalink":"/zio-metrics-connectors/metrics/metric-reference"}}');var i=n(74848),o=n(28453);const s={id:"index",title:"Metrics"},c=void 0,a={},l=[{value:"Adding ZIO Metrics Connectors to your project",id:"adding-zio-metrics-connectors-to-your-project",level:3},{value:"General Metric architecture",id:"general-metric-architecture",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"ZIO Metrics enables the instrumentation of any ZIO based application with specialized aspects. The type of the original ZIO effect will not change by adding on or more aspects to it."}),"\n",(0,i.jsx)(t.p,{children:"Whenever an instrumented effect executes, all the aspects will be executed as well and each of the\naspects will capture some data of interest and update some Metric internal state. Which data will be captured and how it can be used later on is dependent on the metric type associated with the aspect."}),"\n",(0,i.jsxs)(t.p,{children:["Metrics are normally captured to be displayed in an application like ",(0,i.jsx)(t.a,{href:"https://grafana.com/",children:"Grafana"})," or a cloud based platform like ",(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/",children:"DatadogHQ"}),"\nor ",(0,i.jsx)(t.a,{href:"https://newrelic.com",children:"NewRelic"}),".\nIn order to support such a range of different platforms, the metric state is kept in an internal data structure optimized to update the state as efficiently as possible\nand the data required by one or more of the platforms is generated only when it is required."]}),"\n",(0,i.jsx)(t.p,{children:"ZIO Metrics Connectors also allows us to dump current metric states (in one of the next minor releases) out of the box to analyze the metrics in the development phase before the decision\nfor a metric platform has been made or in cases when the platform might not be feasible to use in development."}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["Changing the targeted reporting back end will have no impact on the application at all. Once instrumented properly, that reporting back end decision will happen ",(0,i.jsx)(t.strong,{children:"at the end of the world"}),"\nin the ZIO applications mainline by injecting one or more of the available reporting clients."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Currently, ZIO Metrics Connectors provides integrations with the following backends:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://prometheus.io/",children:"Prometheus"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/",children:"Datadog"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://newrelic.com",children:"New Relic"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/statsd/statsd",children:"StatsD"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://micrometer.io",children:"Micrometer"})}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"adding-zio-metrics-connectors-to-your-project",children:"Adding ZIO Metrics Connectors to your project"}),"\n",(0,i.jsx)(t.p,{children:"Import the corresponding dependency based on your reporting infrastructure:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sbt",children:'libraryDependencies ++= {\n  Seq(\n    "dev.zio" %% "zio-metrics-connectors"             % "2.3.1", // core library\n    "dev.zio" %% "zio-metrics-connectors-prometheus"  % "2.3.1", // Prometheus client\n    "dev.zio" %% "zio-metrics-connectors-datadog"     % "2.3.1", // DataDog client\n    "dev.zio" %% "zio-metrics-connectors-newrelic"    % "2.3.1", // NewRelic client\n    "dev.zio" %% "zio-metrics-connectors-statsd"      % "2.3.1", // StatsD client\n    "dev.zio" %% "zio-metrics-connectors-micrometer"  % "2.3.1"  // Micrometer client\n  )\n}\n'})}),"\n",(0,i.jsx)(t.h2,{id:"general-metric-architecture",children:"General Metric architecture"}),"\n",(0,i.jsxs)(t.p,{children:["All metrics have a name of type ",(0,i.jsx)(t.code,{children:"String"})," which may be augmented by zero or many ",(0,i.jsx)(t.code,{children:"Label"}),"s. A ",(0,i.jsx)(t.code,{children:"Label"})," is simply a key/value pair to further qualify the name.\nThe distinction is made, because some reporting platforms support tags as well and provide certain aggregation mechanisms for them."]}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["For example, think of a counter that simply counts how often a particular service has been invoked. If the application\nis deployed across several hosts, we might model our counter with a name ",(0,i.jsx)(t.code,{children:"myService"}),"and an additional label\n",(0,i.jsx)(t.code,{children:"(host, ${hostname})"}),". With such a definition we would see the number of executions for each host, but we could also\ncreate a query in Grafana or DatadogHQ to visualize the aggregated value over all hosts. Using more than one label\nwould allow to create visualizations across any combination of the labels."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["An important aspect of metric aspects is that they ",(0,i.jsx)(t.em,{children:"understand"})," values of a certain type. For example, a Gauge\nunderstands ",(0,i.jsx)(t.code,{children:"Double"})," values to manipulate the current value within the gauge. This implies, that for effects\n",(0,i.jsx)(t.code,{children:"ZIO[R, E, A]"})," where ",(0,i.jsx)(t.code,{children:"A"})," can not be assigned to a ",(0,i.jsx)(t.code,{children:"Double"})," we have to provide a mapping function ",(0,i.jsx)(t.code,{children:"A => Double"})," so that\nwe can derive the measured value from the effect\xb4s result."]}),"\n",(0,i.jsxs)(t.p,{children:["Finally, more complex metrics might require additional information to specify them completely. For example, within a\n",(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/metric-reference#histograms",children:"histogram"})," we need to specify the buckets the observed values shall be counted in."]}),"\n",(0,i.jsx)(t.p,{children:"Please refer to"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/metric-reference",children:"Metrics Reference"})," for more information on the metrics currently supported"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/prometheus-client",children:"Prometheus Client"})," to learn more about the mapping from ZIO Metrics to Prometheus"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/statsd-client",children:"StatsD Client"})," to learn more about the mapping from ZIO Metrics to StatsD"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/datadog-client",children:"DataDog Client"})," to learn more about the mapping from ZIO Metrics to DataDog"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/zio-metrics-connectors/metrics/micrometer-connector",children:"Micrometer"})," to learn more about the mapping from ZIO Metrics to Micrometer"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);