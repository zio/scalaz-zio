"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[72523],{57599:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>u,toc:()=>a});const u=JSON.parse('{"id":"reference/stm/tqueue","title":"TQueue","description":"A TQueue[A] is a mutable queue that can participate in transactions in STM.","source":"@site/docs/reference/stm/tqueue.md","sourceDirName":"reference/stm","slug":"/reference/stm/tqueue","permalink":"/reference/stm/tqueue","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/reference/stm/tqueue.md","tags":[],"version":"current","frontMatter":{"id":"tqueue","title":"TQueue"},"sidebar":"reference-sidebar","previous":{"title":"TPromise","permalink":"/reference/stm/tpromise"},"next":{"title":"TReentrantLock","permalink":"/reference/stm/treentrantlock"}}');var i=t(74848),s=t(28453);const r={id:"tqueue",title:"TQueue"},o=void 0,l={},a=[{value:"Create a TQueue",id:"create-a-tqueue",level:2},{value:"Put element(s) in a TQueue",id:"put-elements-in-a-tqueue",level:2},{value:"Retrieve element(s) from a TQueue",id:"retrieve-elements-from-a-tqueue",level:2},{value:"Size of a TQueue",id:"size-of-a-tqueue",level:2}];function c(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:"TQueue[A]"})," is a mutable queue that can participate in transactions in STM."]}),"\n",(0,i.jsx)(n.h2,{id:"create-a-tqueue",children:"Create a TQueue"}),"\n",(0,i.jsxs)(n.p,{children:["Creating an empty bounded ",(0,i.jsx)(n.code,{children:"TQueue"})," with specified capacity:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueBounded: STM[Nothing, TQueue[Int]] = TQueue.bounded[Int](5)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Creating an empty unbounded ",(0,i.jsx)(n.code,{children:"TQueue"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueUnbounded: STM[Nothing, TQueue[Int]] = TQueue.unbounded[Int]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"put-elements-in-a-tqueue",children:"Put element(s) in a TQueue"}),"\n",(0,i.jsxs)(n.p,{children:["In order to put an element to a ",(0,i.jsx)(n.code,{children:"TQueue"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueOffer: UIO[TQueue[Int]] = (for {\n  tQueue <- TQueue.bounded[Int](3)\n  _      <- tQueue.offer(1)\n} yield tQueue).commit\n"})}),"\n",(0,i.jsx)(n.p,{children:"The specified element will be successfully added to a queue if the queue is not full.\nIt will wait for an empty slot in the queue otherwise."}),"\n",(0,i.jsx)(n.p,{children:"Alternatively, you can provide a list of elements:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueOfferAll: UIO[TQueue[Int]] = (for {\n  tQueue <- TQueue.bounded[Int](3)\n  _      <- tQueue.offerAll(List(1, 2))\n} yield tQueue).commit\n"})}),"\n",(0,i.jsx)(n.h2,{id:"retrieve-elements-from-a-tqueue",children:"Retrieve element(s) from a TQueue"}),"\n",(0,i.jsx)(n.p,{children:"The first element of the queue can be obtained as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueTake: UIO[Int] = (for {\n  tQueue <- TQueue.bounded[Int](3)\n  _      <- tQueue.offerAll(List(1, 2))\n  res    <- tQueue.take\n} yield res).commit\n"})}),"\n",(0,i.jsx)(n.p,{children:"In case the queue is empty it will block execution waiting for the element you're asking for."}),"\n",(0,i.jsxs)(n.p,{children:["This behavior can be avoided by using ",(0,i.jsx)(n.code,{children:"poll"})," method that will return an element if exists or ",(0,i.jsx)(n.code,{children:"None"})," otherwise:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueuePoll: UIO[Option[Int]] = (for {\n  tQueue <- TQueue.bounded[Int](3)\n  res    <- tQueue.poll\n} yield res).commit\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Retrieving first ",(0,i.jsx)(n.code,{children:"n"})," elements of the queue:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueTakeUpTo: UIO[Chunk[Int]] = (for {\n  tQueue <- TQueue.bounded[Int](4)\n  _      <- tQueue.offerAll(List(1, 2))\n  res    <- tQueue.takeUpTo(3)\n} yield res).commit\n"})}),"\n",(0,i.jsx)(n.p,{children:"All elements of the queue can be obtained as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueTakeAll: UIO[Chunk[Int]] = (for {\n  tQueue <- TQueue.bounded[Int](4)\n  _      <- tQueue.offerAll(List(1, 2))\n  res    <- tQueue.takeAll\n} yield res).commit\n"})}),"\n",(0,i.jsx)(n.h2,{id:"size-of-a-tqueue",children:"Size of a TQueue"}),"\n",(0,i.jsx)(n.p,{children:"The number of elements in the queue can be obtained as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tQueueSize: UIO[Int] = (for {\n  tQueue <- TQueue.bounded[Int](3)\n  _      <- tQueue.offerAll(List(1, 2))\n  size   <- tQueue.size\n} yield size).commit\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var u=t(96540);const i={},s=u.createContext(i);function r(e){const n=u.useContext(s);return u.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),u.createElement(s.Provider,{value:n},e.children)}}}]);