"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[19517],{80761:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"reference/stm/tarray","title":"TArray","description":"TArray is an array of mutable references that can participate in transactions in STM.","source":"@site/docs/reference/stm/tarray.md","sourceDirName":"reference/stm","slug":"/reference/stm/tarray","permalink":"/reference/stm/tarray","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/reference/stm/tarray.md","tags":[],"version":"current","frontMatter":{"id":"tarray","title":"TArray"},"sidebar":"reference-sidebar","previous":{"title":"STM","permalink":"/reference/stm/stm.md"},"next":{"title":"TRandom","permalink":"/reference/stm/trandom"}}');var t=a(74848),s=a(28453);const i={id:"tarray",title:"TArray"},o=void 0,l={},c=[{value:"Create a TArray",id:"create-a-tarray",level:2},{value:"Retrieve the value from a TArray",id:"retrieve-the-value-from-a-tarray",level:2},{value:"Update the value of a TArray",id:"update-the-value-of-a-tarray",level:2},{value:"Transform elements of a TArray",id:"transform-elements-of-a-tarray",level:2},{value:"Perform effects for TArray elements",id:"perform-effects-for-tarray-elements",level:2}];function d(e){const r={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"TArray"})," is an array of mutable references that can participate in transactions in STM."]}),"\n",(0,t.jsx)(r.h2,{id:"create-a-tarray",children:"Create a TArray"}),"\n",(0,t.jsxs)(r.p,{children:["Creating an empty ",(0,t.jsx)(r.code,{children:"TArray"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval emptyTArray: STM[Nothing, TArray[Int]] = TArray.empty[Int]\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Or creating a ",(0,t.jsx)(r.code,{children:"TArray"})," with specified values:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval specifiedValuesTArray: STM[Nothing, TArray[Int]] = TArray.make(1, 2, 3)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Alternatively, you can create a ",(0,t.jsx)(r.code,{children:"TArray"})," by providing a collection of values:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval iterableTArray: STM[Nothing, TArray[Int]] = TArray.fromIterable(List(1, 2, 3))\n"})}),"\n",(0,t.jsx)(r.h2,{id:"retrieve-the-value-from-a-tarray",children:"Retrieve the value from a TArray"}),"\n",(0,t.jsx)(r.p,{children:"The n-th element of the array can be obtained as follows:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tArrayGetElem: UIO[Int] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  elem   <- tArray(2)\n} yield elem).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Accessing the non-existing indexes aborts the transaction with ",(0,t.jsx)(r.code,{children:"ArrayIndexOutOfBoundsException"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"update-the-value-of-a-tarray",children:"Update the value of a TArray"}),"\n",(0,t.jsx)(r.p,{children:"Updating the n-th element of an array can be done as follows:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tArrayUpdateElem: UIO[TArray[Int]] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  _      <- tArray.update(2, el => el + 10)\n} yield tArray).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Updating the n-th element of an array can be done effectfully via ",(0,t.jsx)(r.code,{children:"updateSTM"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval tArrayUpdateMElem: UIO[TArray[Int]] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  _      <- tArray.updateSTM(2, el => STM.succeed(el + 10))\n} yield tArray).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Updating the non-existing indexes aborts the transaction with ",(0,t.jsx)(r.code,{children:"ArrayIndexOutOfBoundsException"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"transform-elements-of-a-tarray",children:"Transform elements of a TArray"}),"\n",(0,t.jsxs)(r.p,{children:["The transform function ",(0,t.jsx)(r.code,{children:"A => A"})," allows computing a new value for every element in the array:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval transformTArray: UIO[TArray[Int]] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  _      <- tArray.transform(a => a * a)\n} yield tArray).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["The elements can be mapped effectfully via ",(0,t.jsx)(r.code,{children:"transformSTM"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval transformSTMTArray: UIO[TArray[Int]] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  _      <- tArray.transformSTM(a => STM.succeed(a * a))\n} yield tArray).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Folds the elements of a ",(0,t.jsx)(r.code,{children:"TArray"})," using the specified associative binary operator:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval foldTArray: UIO[Int] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  sum    <- tArray.fold(0)(_ + _)\n} yield sum).commit\n"})}),"\n",(0,t.jsxs)(r.p,{children:["The elements can be folded effectfully via ",(0,t.jsx)(r.code,{children:"foldSTM"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval foldSTMTArray: UIO[Int] = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  sum    <- tArray.foldSTM(0)((acc, el) => STM.succeed(acc + el))\n} yield sum).commit\n"})}),"\n",(0,t.jsx)(r.h2,{id:"perform-effects-for-tarray-elements",children:"Perform effects for TArray elements"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"foreach"})," is used for performing an STM effect for each element in the array:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-scala",children:"import zio._\nimport zio.stm._\n\nval foreachTArray = (for {\n  tArray <- TArray.make(1, 2, 3, 4)\n  tQueue <- TQueue.unbounded[Int]\n  _      <- tArray.foreach(a => tQueue.offer(a).unit)\n} yield tArray).commit\n"})})]})}function m(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,r,a)=>{a.d(r,{R:()=>i,x:()=>o});var n=a(96540);const t={},s=n.createContext(t);function i(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);