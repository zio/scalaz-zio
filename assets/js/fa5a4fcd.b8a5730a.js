"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[58273],{16607:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"ecosystem/community/zio-nebula","title":"ZIO NebulaGraph","description":"zio-nebula is a simple wrapper around nebula-java for easier integration with NebulaGraph into Scala, ZIO applications.","source":"@site/docs/ecosystem/community/zio-nebula.md","sourceDirName":"ecosystem/community","slug":"/ecosystem/community/zio-nebula","permalink":"/ecosystem/community/zio-nebula","draft":false,"unlisted":false,"editUrl":"https://github.com/zio/zio/edit/series/2.x/docs/ecosystem/community/zio-nebula.md","tags":[],"version":"current","frontMatter":{"id":"zio-nebula","title":"ZIO NebulaGraph"},"sidebar":"ecosystem-sidebar","previous":{"title":"ZIO Kinesis","permalink":"/ecosystem/community/zio-kinesis"},"next":{"title":"ZIO Pulsar","permalink":"/ecosystem/community/zio-pulsar"}}');var l=t(74848),s=t(28453);const o={id:"zio-nebula",title:"ZIO NebulaGraph"},a=void 0,r={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Installation",id:"installation",level:2},{value:"Example",id:"example",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/nebula-contrib/zio-nebula",children:"zio-nebula"})," is a simple wrapper around ",(0,l.jsx)(n.a,{href:"https://github.com/vesoft-inc/nebula-java/",children:"nebula-java"})," for easier integration with ",(0,l.jsx)(n.a,{href:"https://github.com/vesoft-inc/nebula",children:"NebulaGraph"})," into Scala, ZIO applications."]}),"\n",(0,l.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Supports all clients: Session Pool\u3001Pool\u3001Storage\u3001Meta"}),"\n",(0,l.jsx)(n.li,{children:"Support for configuring clients with typesafe config"}),"\n",(0,l.jsx)(n.li,{children:"Other optimizations suitable for Scala pure functional"}),"\n",(0,l.jsx)(n.li,{children:"Support Scala 3, Scala 2.13 and Scala 2.12"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,l.jsxs)(n.p,{children:["In order to use this library, we need to add the following line in our ",(0,l.jsx)(n.code,{children:"build.sbt"})," file:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:'libraryDependencies += "io.github.jxnu-liguobin" %% "zio-nebula" % <version>\n'})}),"\n",(0,l.jsx)(n.p,{children:"There are the version correspondence between zio-nebula and nebula-java:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"center"},children:"zio"}),(0,l.jsx)(n.th,{style:{textAlign:"center"},children:"zio-nebula"}),(0,l.jsx)(n.th,{style:{textAlign:"center"},children:"nebula-java"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"2.0.x"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"0.0.x"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"3.6.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"2.0.x"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"0.1.0"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"3.6.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"2.0.x"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"0.1.1"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"3.6.1"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,l.jsx)(n.p,{children:"Usually, we use a session client, which can be conveniently used in ZIO applications like this:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-scala",children:"import zio._\nimport zio.nebula._\n\nfinal class NebulaSessionClientExample(sessionClient: NebulaSessionClient) {\n\n  def execute(stmt: String): ZIO[Any, Throwable, NebulaResultSet] = {\n    // your business logic\n    sessionClient.execute(stmt)\n  }\n}\n\nobject NebulaSessionClientExample {\n  lazy val layer = ZLayer.fromFunction(new NebulaSessionClientExample(_))\n}\n\nobject NebulaSessionClientMain extends ZIOAppDefault {\n\n  override def run = (for {\n    _ <- ZIO.serviceWithZIO[NebulaSessionClient](_.init()) // since 0.1.1, no need to call it manually. \n    _ <- ZIO.serviceWithZIO[NebulaSessionClientExample](\n             _.execute(\"\"\"\n                         |INSERT VERTEX person(name, age) VALUES \n                         |'Bob':('Bob', 10), \n                         |'Lily':('Lily', 9),'Tom':('Tom', 10),\n                         |'Jerry':('Jerry', 13),\n                         |'John':('John', 11);\"\"\".stripMargin)\n           )\n    _ <- ZIO.serviceWithZIO[NebulaSessionClientExample](\n             _.execute(\"\"\"\n                         |INSERT EDGE like(likeness) VALUES\n                         |'Bob'->'Lily':(80.0),\n                         |'Bob'->'Tom':(70.0),\n                         |'Lily'->'Jerry':(84.0),\n                         |'Tom'->'Jerry':(68.3),\n                         |'Bob'->'John':(97.2);\"\"\".stripMargin)\n           )\n    _ <- ZIO.serviceWithZIO[NebulaSessionClientExample](\n             _.execute(\"\"\"\n                         |USE test;\n                         |MATCH (p:person) RETURN p LIMIT 4;\n                         |\"\"\".stripMargin)\n           )\n  } yield ())\n    .provide(\n      Scope.default,\n      NebulaSessionClientExample.layer,\n      SessionClientEnv\n    )\n\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"Add configuration in classpath:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-hocon",children:'{\n  graph {\n    address = [\n      {\n        host = "127.0.0.1",\n        port = 9669\n      }\n    ]\n    auth {\n      username = "root"\n      password = "nebula"\n    }\n    spaceName = "test"\n    reconnect = true\n  }\n\n  meta {\n    address = [\n      {\n        host = "127.0.0.1",\n        port = 9559\n      }\n    ]\n    timeoutMills = 30000\n    connectionRetry = 3\n    executionRetry = 1\n    enableSSL = false\n  }\n\n  storage {\n    address = [\n      {\n        host = "127.0.0.1",\n        port = 9559\n      }\n    ]\n    timeoutMills = 30000\n    connectionRetry = 3\n    executionRetry = 1\n    enableSSL = false\n  }\n\n  pool {\n    timeoutMills = 60000\n    enableSsl = false\n    minConnsSize = 10\n    maxConnsSize = 10\n    intervalIdleMills = 100\n    waitTimeMills = 100\n  }\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(96540);const l={},s=i.createContext(l);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);